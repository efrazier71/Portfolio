SELECT SERVICENOW.SC_TASK.NUMBER_
	,SERVICENOW.SC_TASK.CLOSED_AT
	,SERVICENOW.SC_TASK.OPENED_AT
	,SERVICENOW.SYS_USER.NAME AS REQUESTER
	,SERVICENOW.SYS_USER.U_EXEC_LEVEL AS REQUESTER_EXEC_LEVEL
	,SERVICENOW.SYS_USER.U_AFFILIATION
	,SERVICENOW.CMN_DEPARTMENT.NAME AS DEPARTMENT_NAME
	,INITCAP(SERVICENOW.SYS_USER_GROUP.NAME) AS ASSIGNMENT_GROUP
	,INITCAP(SERVICENOW.SC_TASK.CONTACT_TYPE) AS CONTACT_TYPE
	,SYS_USER1.NAME AS DIRECTOR
	,SYS_USER2.NAME AS SENIOR_DIRECTOR
	,SYS_USER1.U_EXEC_LEVEL AS DIRECTOR_EXEC
	,SYS_USER2.U_EXEC_LEVEL AS S_DIRECTOR_EXEC
	,'SC_TASK' AS TABLE_NAME
	,CAST(SERVICENOW.SC_TASK.STATE AS VARCHAR2(40)) AS STATE
	,SYS_USER3.NAME AS CLOSED_BY
	,SERVICENOW.CMDB_CI.NAME AS BUSINESS_SERVICE
	,SERVICENOW.SC_TASK.REASSIGNMENT_COUNT
	,SYS_USER4.NAME AS ASSIGNED_TO
	,'NULL' AS DOCUMENT_TABLE
FROM SERVICENOW.SC_REQUEST
LEFT JOIN SERVICENOW.SYS_USER ON SERVICENOW.SYS_USER.SYS_ID = SERVICENOW.SC_REQUEST.REQUESTED_FOR
LEFT JOIN SERVICENOW.CMN_DEPARTMENT ON SERVICENOW.CMN_DEPARTMENT.SYS_ID = SERVICENOW.SYS_USER.DEPARTMENT
LEFT JOIN SERVICENOW.SC_TASK ON SERVICENOW.SC_REQUEST.SYS_ID = SERVICENOW.SC_TASK.REQUEST
LEFT JOIN SERVICENOW.SYS_USER_GROUP ON SERVICENOW.SYS_USER_GROUP.SYS_ID = SERVICENOW.SC_TASK.ASSIGNMENT_GROUP
LEFT JOIN SERVICENOW.SYS_USER SYS_USER1 ON SYS_USER1.SYS_ID = SERVICENOW.SYS_USER_GROUP.U_DIRECTOR
LEFT JOIN SERVICENOW.SYS_USER SYS_USER2 ON SYS_USER2.SYS_ID = SERVICENOW.SYS_USER_GROUP.U_SR_DIRECTOR
LEFT JOIN SERVICENOW.SYS_USER SYS_USER3 ON SYS_USER3.SYS_ID = SERVICENOW.SC_TASK.CLOSED_BY
LEFT JOIN SERVICENOW.CMDB_CI ON SERVICENOW.CMDB_CI.SYS_ID = SERVICENOW.SC_TASK.BUSINESS_SERVICE
LEFT JOIN SERVICENOW.SYS_USER SYS_USER4 ON SYS_USER4.SYS_ID = SERVICENOW.SC_TASK.ASSIGNED_TO

UNION

SELECT SERVICENOW.INCIDENT.NUMBER_
	,SERVICENOW.INCIDENT.CLOSED_AT
	,SERVICENOW.INCIDENT.OPENED_AT
	,SERVICENOW.SYS_USER.NAME AS REQUESTER
	,SERVICENOW.SYS_USER.U_EXEC_LEVEL AS REQUESTER_EXEC_LEVEL
	,SERVICENOW.SYS_USER.U_AFFILIATION
	,SERVICENOW.CMN_DEPARTMENT.NAME AS DEPARTMENT_NAME
	,INITCAP(SERVICENOW.SYS_USER_GROUP.NAME) AS ASSIGNMENT_GROUP
	,INITCAP(SERVICENOW.INCIDENT.CONTACT_TYPE)
	,SYS_USER1.NAME AS DIRECTOR
	,SYS_USER2.NAME AS SENIOR_DIRECTOR
	,SYS_USER2.U_EXEC_LEVEL AS DIRECTOR_EXEC
	,SYS_USER1.U_EXEC_LEVEL AS S_DIRECTOR_EXEC
	,'INCIDENT' AS TABLE_NAME
	,CAST(SERVICENOW.INCIDENT.STATE AS VARCHAR2(40)) AS STATE
	,SYS_USER3.NAME AS CLOSE_BY
	,SERVICENOW.CMDB_CI.NAME AS BUSINESS_SERVICE
	,SERVICENOW.INCIDENT.REASSIGNMENT_COUNT
	,SYS_USER4.NAME AS ASSIGNED_TO
	,'NULL' AS DOCUMENT_TABLE
FROM SERVICENOW.INCIDENT
LEFT JOIN SERVICENOW.SYS_USER_GROUP ON SERVICENOW.SYS_USER_GROUP.SYS_ID = SERVICENOW.INCIDENT.ASSIGNMENT_GROUP
LEFT JOIN SERVICENOW.SYS_USER SYS_USER1 ON SYS_USER1.SYS_ID = SERVICENOW.SYS_USER_GROUP.U_DIRECTOR
LEFT JOIN SERVICENOW.SYS_USER SYS_USER2 ON SYS_USER2.SYS_ID = SERVICENOW.SYS_USER_GROUP.U_SR_DIRECTOR
LEFT JOIN SERVICENOW.SYS_USER ON SERVICENOW.SYS_USER.SYS_ID = SERVICENOW.INCIDENT.CALLER_ID
LEFT JOIN SERVICENOW.CMN_DEPARTMENT ON SERVICENOW.CMN_DEPARTMENT.SYS_ID = SERVICENOW.SYS_USER.DEPARTMENT
LEFT JOIN SERVICENOW.SYS_USER SYS_USER3 ON SYS_USER3.SYS_ID = SERVICENOW.INCIDENT.CLOSED_BY
LEFT JOIN SERVICENOW.CMDB_CI ON SERVICENOW.CMDB_CI.SYS_ID = SERVICENOW.INCIDENT.BUSINESS_SERVICE
LEFT JOIN SERVICENOW.SYS_USER SYS_USER4 ON SYS_USER4.SYS_ID = SERVICENOW.INCIDENT.ASSIGNED_TO

UNION

SELECT SERVICENOW.INTERACTION.NUMBER_
	,SERVICENOW.INTERACTION.CLOSED_AT
	,SERVICENOW.INTERACTION.OPENED_AT
	,SERVICENOW.SYS_USER.NAME AS REQUESTER
	,SERVICENOW.SYS_USER.U_EXEC_LEVEL AS REQUESTER_EXEC_LEVEL
	,SERVICENOW.SYS_USER.U_AFFILIATION
	,SERVICENOW.CMN_DEPARTMENT.NAME AS DEPARTMENT_NAME
	,INITCAP(SERVICENOW.SYS_USER_GROUP.NAME) AS ASSIGNMENT_GROUP
	,INITCAP(SERVICENOW.INTERACTION.TYPE) AS CONTACT_TYPE
	,SYS_USER1.NAME AS DIRECTOR
	,SYS_USER2.NAME AS SENIOR_DIRECTOR
	,SYS_USER1.U_EXEC_LEVEL AS DIRECTOR_EXEC
	,SYS_USER2.U_EXEC_LEVEL AS S_DIRECTOR_EXEC
	,'INTERACTION' AS TABLE_NAME
	,SERVICENOW.INTERACTION.STATE
	,SYS_USER3.NAME AS CLOSED_BY
	,SERVICENOW.CMDB_CI.NAME AS BUSINESS_SERVICE
	,CAST(0 AS INT) AS REASSIGNMENT_COUNT
	,SYS_USER4.NAME AS ASSIGNED_TO
	,SERVICENOW.INTERACTION_RELATED_RECORD.DOCUMENT_TABLE
FROM SERVICENOW.INTERACTION
LEFT JOIN SERVICENOW.SYS_USER ON SERVICENOW.SYS_USER.SYS_ID = SERVICENOW.INTERACTION.OPENED_FOR
LEFT JOIN SERVICENOW.SYS_USER_GROUP ON SERVICENOW.SYS_USER_GROUP.SYS_ID = SERVICENOW.INTERACTION.ASSIGNMENT_GROUP
LEFT JOIN SERVICENOW.CMN_DEPARTMENT ON SERVICENOW.SYS_USER.DEPARTMENT = SERVICENOW.CMN_DEPARTMENT.SYS_ID
LEFT JOIN SERVICENOW.SYS_USER SYS_USER1 ON SYS_USER1.SYS_ID = SERVICENOW.SYS_USER_GROUP.U_DIRECTOR
LEFT JOIN SERVICENOW.SYS_USER SYS_USER2 ON SYS_USER2.SYS_ID = SERVICENOW.SYS_USER_GROUP.U_SR_DIRECTOR
LEFT JOIN SERVICENOW.SYS_USER SYS_USER3 ON SYS_USER3.SYS_ID = SERVICENOW.INTERACTION.CLOSED_BY
LEFT JOIN SERVICENOW.CMDB_CI ON SERVICENOW.CMDB_CI.SYS_ID = SERVICENOW.INTERACTION.U_BUSINESS_SERVICE
LEFT JOIN SERVICENOW.SYS_USER SYS_USER4 ON SYS_USER4.SYS_ID = SERVICENOW.INTERACTION.ASSIGNED_TO
LEFT JOIN SERVICENOW.INTERACTION_RELATED_RECORD ON SERVICENOW.INTERACTION.SYS_ID = SERVICENOW.INTERACTION_RELATED_RECORD.INTERACTION
